<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <!-- Impedisce lo zoom su mobile -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>Pacchetto Wellness - Trilussa Palace Hotel</title>
  <meta
    name="description"
    content="Richiedi un preventivo personalizzato per il tuo pacchetto wellness presso il Trilussa Palace Hotel. Scegli tra diverse opzioni Spa e Extra per un'esperienza di relax unica."
  />
  <link
    href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap"
    rel="stylesheet"
  />
  <style>
    /* Definizione della palette di colori */
    :root {
      --primary-color: #6D4C41; /* Marrone scuro */
      --secondary-color: #8D6E63; /* Marrone chiaro */
      --accent-color: #FFA726; /* Arancione */
      --background-color: #f2efed; /* Aggiornato */
      --text-color: #333333; /* Grigio scuro */
      --price-bar-color: #8D6E63; /* Marrone chiaro */
      --button-color: #6D4C41; /* Marrone scuro */
      --button-hover-color: #8D6E63; /* Marrone chiaro */
      --input-border-color: #cccccc;
      --option-hover-bg: #e0e0e0;
      --modal-bg: rgba(0, 0, 0, 0.5);
      --spinner-color: #6D4C41;
    }

    /* Impostazioni base per rimuovere scroll e sfruttare tutto lo spazio */
    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      font-family: 'Roboto', sans-serif;
      background: var(--background-color); /* Aggiornato */
      /* Nessun overflow, così da non mostrare barre di scroll */
      overflow: hidden; 
    }

    /* Barra fissa con il totale */
    .price-bar {
      position: absolute;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      background-color: var(--price-bar-color);
      color: white;
      padding: 16px 32px; /* Aumentato il padding */
      border-radius: 0 0 20px 20px; /* Aumentato il border-radius */
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2); /* Aumentata l'ombra */
      font-size: 1.6rem; /* Aumentata la dimensione del font */
      z-index: 1000;
      font-weight: 700;
    }

    /* Contenitore a piena altezza (meno lo spazio della barra) */
    .container {
      position: absolute;
      top: 80px; /* Altezza della .price-bar + padding */
      left: 50%;
      transform: translateX(-50%);
      width: 90%; /* Allargato */
      max-width: 600px; /* Ridotto il max-width per una dimensione più contenuta */
      bottom: 20px; /* Aggiunto un po' di spazio in basso */
      padding: 20px;
      box-sizing: border-box;
      background: var(--background-color);

      /* Utilizzo di Flexbox per distribuire lo spazio */
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      align-items: center;

      /* Rimuovere l'overflow */
      overflow: hidden;
    }

    .container h1 {
      color: var(--primary-color);
      font-size: 2rem; /* Ridotto leggermente */
      margin-top: 0;
      margin-bottom: 20px; /* Aumentato */
      font-weight: 700;
      text-align: center;
    }

    .container p {
      color: var(--text-color);
      font-size: 1.2rem; /* Aumentato */
      margin-bottom: 25px; /* Aumentato */
      text-align: center;
      max-width: 600px; /* Aumentato */
    }

    /* Sistemiamo i passaggi/step */
    .step {
      display: none;
      width: 100%;
      max-width: 600px; /* Aumentata la larghezza per ospitare meglio il contenuto */
      background: white;
      padding: 25px; /* Aumentato il padding */
      border-radius: 20px; /* Aumentato il border-radius */
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.1); /* Aumentata l'ombra */
      margin-bottom: 25px; /* Aumentato il margine */
    }
    .step.active {
      display: block;
      animation: fadeIn 0.4s ease-in-out;
    }
    .step-header {
      margin-bottom: 20px; /* Aumentato */
    }
    .step-header h2 {
      font-size: 1.4rem; /* Aumentato */
      color: var(--primary-color);
      margin: 0 0 15px 0; /* Aumentato */
      font-weight: 700;
      text-align: center;
    }

    /* Opzioni */
    .options, .extras {
      display: flex;
      flex-direction: column;
      gap: 15px; /* Aumentato */
    }

    .option {
      display: flex;
      align-items: center;
      padding: 14px; /* Aumentato */
      border: 1px solid var(--input-border-color);
      border-radius: 12px; /* Aumentato */
      background: white;
      transition: background 0.3s ease, transform 0.3s ease;
      font-size: 1rem;
      cursor: pointer;
    }
    .option:hover {
      background: var(--option-hover-bg);
      transform: translateY(-3px); /* Aumentato l'effetto */
    }
    .option label {
      display: flex;
      align-items: center;
      flex: 1;
      font-size: 1rem;
      color: var(--text-color);
      cursor: pointer;
    }
    .option input {
      transform: scale(1.5); /* Aumentata la dimensione */
      margin-right: 20px; /* Aumentato */
      cursor: pointer;
    }

    /* Pulsanti navigazione */
    .navigation-buttons {
      display: flex;
      justify-content: space-between;
      margin-top: 30px; /* Aumentato */
      width: 100%;
      max-width: 600px;
    }
    .navigation-buttons button {
      background-color: var(--button-color);
      color: white;
      padding: 12px 25px; /* Aumentato */
      font-size: 1rem;
      border: none;
      border-radius: 30px; /* Mantenuto */
      cursor: pointer;
      transition: background-color 0.3s ease, transform 0.2s ease;
    }
    .navigation-buttons button:hover {
      background-color: var(--button-hover-color);
      transform: scale(1.05);
    }

    /* Piccola animazione di fadeIn */
    @keyframes fadeIn {
      from { opacity: 0; }
      to   { opacity: 1; }
    }

    /* Riduciamo i margini su schermi piccoli */
    @media (max-width: 600px) {
      .price-bar {
        font-size: 1.4rem; /* Aumentato */
        padding: 12px 24px; /* Aumentato */
      }
      .container {
        padding: 20px;
      }
      .container h1 {
        font-size: 2rem; /* Aumentato */
      }
      .step-header h2 {
        font-size: 1.3rem; /* Aumentato */
      }
      .navigation-buttons button {
        padding: 10px 20px; /* Aumentato */
        font-size: 0.9rem;
      }
      .step {
        max-width: 500px; /* Aumentato */
      }
      .container p {
        font-size: 1.1rem;
      }
    }

    /* Stili per il logo */
    .logo-container {
      margin-top: 30px; /* Aumentato */
      text-align: center;
    }

    .logo {
      max-width: 150px; /* Ridotto da 200px per evitare tagli */
      height: auto;
    }

    /* Prevenzione dello zoom quando si interagisce con gli input */
    input, textarea, select, button {
      font-size: 16px; /* Imposta almeno 16px per prevenire lo zoom su mobile */
    }

    /* Stili per il popup */
    .modal {
      display: none; /* Hidden by default */
      position: fixed;
      z-index: 3000; /* Sit on top */
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto; /* Enable scroll if needed */
      background-color: var(--modal-bg); /* Black w/ opacity */
    }

    .modal-content {
      background-color: #fefefe;
      margin: 10% auto; /* 10% from the top and centered */
      padding: 30px;
      border: 1px solid #888;
      width: 80%;
      max-width: 500px;
      border-radius: 15px;
      text-align: center;
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
      position: relative;
    }

    .close-modal {
      color: #aaa;
      position: absolute;
      top: 15px;
      right: 20px;
      font-size: 2rem;
      font-weight: bold;
      cursor: pointer;
    }

    .close-modal:hover,
    .close-modal:focus {
      color: black;
      text-decoration: none;
      cursor: pointer;
    }

    /* Stili per le immagini delle spa */
    .spa-image-container {
      margin-top: 25px; /* Aumentato */
      text-align: center;
    }

    .spa-image {
      max-width: 100%;
      height: auto;
      border-radius: 10px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      display: none; /* Initially hidden */
      margin-top: 15px;
    }

    /* Stili per l'overlay di caricamento */
   
  </style>
</head>

<body>
  <!-- Barra con il totale -->
  <div class="price-bar">
    Totale: <span id="totalPrice">0</span>€
  </div>

  <div class="container">
    <div>
      <h1>Pacchetto Wellness</h1>
      <p>Scegli le opzioni per il tuo relax presso il Trilussa Palace Hotel:</p>

      <form
        id="wellnessForm"
        action="https://script.google.com/macros/s/AKfycbxytaalqXiGvZr2ZneImOD1Os6llLJ-K4hssNHpVw4X_p15xD_rf7bogK2o5GVQcpYYkg/exec" 
        method="POST"
        target="hiddenFrame"
      >
        <!-- STEP 1: Scegli la Spa -->
        <div class="step active" id="step-1">
          <div class="step-header">
            <h2>1. Scegli la Spa</h2>
          </div>
          <div class="options">
            <div class="option">
              <label>
                <input
                  type="radio"
                  name="spa"
                  class="option-radio"
                  data-price="0"
                  value="SPA MAYA"
                  required
                />
                SPA MAYA
              </label>
            </div>
            <div class="option">
              <label>
                <input
                  type="radio"
                  name="spa"
                  class="option-radio"
                  data-price="0"
                  value="SPA MOON"
                  required
                />
                SPA MOON
              </label>
            </div>
            <div class="option">
              <label>
                <input
                  type="radio"
                  name="spa"
                  class="option-radio"
                  data-price="0"
                  value="SPA DOMUS"
                  required
                />
                SPA DOMUS
              </label>
            </div>
          </div>
          <!-- Container per le immagini delle spa -->
          <div class="spa-image-container">
            <img src="https://via.placeholder.com/600x400?text=SPA+MAYA" alt="SPA MAYA" class="spa-image" id="spa-image-spa-maya" />
            <img src="https://via.placeholder.com/600x400?text=SPA+MOON" alt="SPA MOON" class="spa-image" id="spa-image-spa-moon" />
            <img src="https://via.placeholder.com/600x400?text=SPA+DOMUS" alt="SPA DOMUS" class="spa-image" id="spa-image-spa-domus" />
          </div>
          <div class="navigation-buttons">
            <div></div> <!-- Spazio vuoto per allineamento -->
            <button type="button" onclick="nextStep(1)">Avanti</button>
          </div>
        </div>

        <!-- STEP 2: Scegli la Fascia Oraria -->
        <div class="step" id="step-2">
          <div class="step-header">
            <h2>2. Scegli la Fascia Oraria</h2>
          </div>
          <div class="options">
            <div class="option">
              <label>
                <input
                  type="radio"
                  name="time"
                  class="option-radio"
                  data-price="0"
                  value="MATTINA (08:00-16:00)"
                  required
                />
                MATTINA (08:00-16:00)
              </label>
            </div>
            <div class="option">
              <label>
                <input
                  type="radio"
                  name="time"
                  class="option-radio"
                  data-price="0"
                  value="POMERIGGIO (16:00-23:00)"
                  required
                />
                POMERIGGIO (16:00-23:00)
              </label>
            </div>
            <div class="option">
              <label>
                <input
                  type="radio"
                  name="time"
                  class="option-radio"
                  data-price="0"
                  value="NOTTE (23:00-08:00)"
                  required
                />
                NOTTE (23:00-08:00)
              </label>
            </div>
          </div>
          <div class="navigation-buttons">
            <button type="button" onclick="prevStep(2)">Indietro</button>
            <button type="button" onclick="nextStep(2)">Avanti</button>
          </div>
        </div>

        <!-- STEP 3: Scegli la Durata e Numero di Persone -->
        <div class="step" id="step-3">
          <div class="step-header">
            <h2>3. Scegli la Durata e il Numero di Persone</h2>
          </div>
          <div class="options">
            <div class="option">
              <label>
                <input
                  type="radio"
                  name="duration"
                  class="option-radio"
                  data-price="0"
                  value="1h"
                  required
                />
                1 Ora
              </label>
            </div>
            <div class="option">
              <label>
                <input
                  type="radio"
                  name="duration"
                  class="option-radio"
                  data-price="0"
                  value="1.30h"
                  required
                />
                1.30 Ore
              </label>
            </div>
          </div>
          <!-- Numero di Persone -->
          <div style="margin-top: 20px;">
            <label for="persons" style="font-weight: bold;">Ospiti (Ospite aggiunto +30€):</label>
            <input
              type="number"
              name="persons"
              id="persons"
              value="2"
              min="2"
              style="width: 100%; padding: 10px; margin-top: 10px; border-radius: 5px; border: 1px solid var(--input-border-color);"
            />
          </div>
          <div class="navigation-buttons">
            <button type="button" onclick="prevStep(3)">Indietro</button>
            <button type="button" onclick="nextStep(3)">Avanti</button>
          </div>
        </div>

        <!-- STEP 4: Scegli gli Extra -->
        <div class="step" id="step-4">
          <div class="step-header">
            <h2>4. Scegli gli Extra</h2>
          </div>
          <div class="extras">
            <div class="option">
              <label>
                <input
                  type="checkbox"
                  class="option-checkbox"
                  data-price="90"
                  name="extras"
                  value="Cena RAMO Bistrot"
                />
                Cena RAMO Bistrot - €90
              </label>
            </div>
            <div class="option">
              <label>
                <input
                  type="checkbox"
                  class="option-checkbox"
                  data-price="35"
                  name="extras"
                  value="Sushi Misto"
                />
                Sushi Misto - €35
              </label>
            </div>
            <div class="option">
              <label>
                <input
                  type="checkbox"
                  class="option-checkbox"
                  data-price="20"
                  name="extras"
                  value="Pinsa"
                />
                Pinsa - €20
              </label>
            </div>
            <div class="option">
              <label>
                <input
                  type="checkbox"
                  class="option-checkbox"
                  data-price="40"
                  name="extras"
                  value="Bottiglia di Prosecco"
                />
                Bottiglia di Prosecco - €40
              </label>
            </div>
          </div>
          <div class="navigation-buttons">
            <button type="button" onclick="prevStep(4)">Indietro</button>
            <button type="button" onclick="nextStep(4)">Avanti</button>
          </div>
        </div>

        <!-- STEP 5: Conferma e invio -->
        <div class="step" id="step-5">
          <div class="step-header">
            <h2>5. Conferma e Richiesta Preventivo</h2>
          </div>
          <div class="section">
            <label style="font-weight:bold;">Email *</label>
            <input
              type="email"
              name="email"
              id="email"
              placeholder="La tua Email"
              required
              style="width: 100%; padding: 12px; border-radius: 5px; border: 1px solid var(--input-border-color); margin-bottom: 20px;"
            />

            <label style="font-weight:bold;">Telefono (opzionale)</label>
            <input
              type="tel"
              name="phone"
              id="phone"
              placeholder="Il tuo Telefono"
              style="width: 100%; padding: 12px; border-radius: 5px; border: 1px solid var(--input-border-color); margin-bottom: 20px;"
            />

            <input type="hidden" name="total" id="total" />
          </div>
          <div class="navigation-buttons">
            <button type="button" onclick="prevStep(5)">Indietro</button>
            <button type="submit">Richiedi Conferma</button>
          </div>
        </div>
      </form>

      <!-- Logo -->
      <div class="logo-container">
        <img src="https://www.trilussasparoma.com/data/png/logo_global.png" alt="Trilussa Palace Hotel Logo" class="logo" />
      </div>

      <!-- Iframe nascosto per l'invio del form -->
      <iframe name="hiddenFrame" style="display:none;"></iframe>

      <!-- Popup di conferma -->
      <div id="confirmationModal" class="modal">
        <div class="modal-content">
          <span class="close-modal" onclick="closeModal()">&times;</span>
          <h2>Richiesta Inviata!</h2>
          <p>Grazie! La tua richiesta è stata inviata con successo.</p>
          <button onclick="closeModal()">Chiudi</button>
        </div>
      </div>

      <!-- Overlay di caricamento -->
      <div id="loadingOverlay" class="loading-overlay">
        <div class="spinner"></div>
      </div>

    </div>

    <script>
      let currentStep = 1;
      const totalSteps = 5;

      function showStep(step) {
        for (let i = 1; i <= totalSteps; i++) {
          document.getElementById(`step-${i}`).classList.remove("active");
        }
        document.getElementById(`step-${step}`).classList.add("active");
      }

      function nextStep(step) {
        if (!validateStep(step)) return;
        if (step < totalSteps) {
          currentStep = step + 1;
          showStep(currentStep);
          updateTotal();
        }
      }

      function prevStep(step) {
        if (step > 1) {
          currentStep = step - 1;
          showStep(currentStep);
        }
      }

      // Convalida radio obbligatori negli step 1,2,3
      function validateStep(step) {
        let valid = true;
        const stepElement = document.getElementById(`step-${step}`);

        if (step === 1 || step === 2 || step === 3) {
          const required = stepElement.querySelectorAll('input[type="radio"]:checked');
          if (required.length === 0) {
            alert("Per favore, completa tutte le scelte obbligatorie.");
            valid = false;
          }
        }
        return valid;
      }

      // Calcolo totale
      function updateTotal() {
        let totalPrice = 0;

        const spaSelected = document.querySelector('input[name="spa"]:checked');
        const timeSelected = document.querySelector('input[name="time"]:checked');
        const durationSelected = document.querySelector('input[name="duration"]:checked');
        const personsInput = document.getElementById("persons");
        let persons = 2;
        if (personsInput) {
          persons = parseInt(personsInput.value) || 2;
        }

        if (spaSelected && timeSelected && durationSelected) {
          const spaPrices = {
            "SPA MAYA": {
              "MATTINA (08:00-16:00)": { "1h": 110, "1.30h": 160 },
              "POMERIGGIO (16:00-23:00)": { "1h": 170, "1.30h": 360 },
              "NOTTE (23:00-08:00)": { "1h": 250, "1.30h": 360 },
            },
            "SPA MOON": {
              "MATTINA (08:00-16:00)": { "1h": 90, "1.30h": 130 },
              "POMERIGGIO (16:00-23:00)": { "1h": 140, "1.30h": 290 },
              "NOTTE (23:00-08:00)": { "1h": 200, "1.30h": 290 },
            },
            "SPA DOMUS": {
              "MATTINA (08:00-16:00)": { "1h": 75, "1.30h": 110 },
              "POMERIGGIO (16:00-23:00)": { "1h": 110, "1.30h": 220 },
              "NOTTE (23:00-08:00)": { "1h": 160, "1.30h": 220 },
            },
          };

          const spaPrice = spaPrices[spaSelected.value][timeSelected.value][durationSelected.value];
          totalPrice += spaPrice;
        }

        if (persons > 2) {
          totalPrice += (persons - 2) * 30;
        }

        const checkboxes = document.querySelectorAll(".option-checkbox:checked");
        checkboxes.forEach((checkbox) => {
          totalPrice += parseFloat(checkbox.dataset.price);
        });

        document.getElementById("totalPrice").textContent = totalPrice.toFixed(2);
        document.getElementById("total").value = totalPrice.toFixed(2);
      }

      const radioButtons = document.querySelectorAll(".option-radio");
      const checkboxes = document.querySelectorAll(".option-checkbox");
      const personsInput = document.getElementById("persons");

      radioButtons.forEach((radio) => {
        radio.addEventListener("change", () => {
          updateTotal();
          updateSpaImage();
        });
      });
      checkboxes.forEach((checkbox) => {
        checkbox.addEventListener("change", updateTotal);
      });
      if (personsInput) {
        personsInput.addEventListener("change", updateTotal);
      }

      // Funzione per aggiornare l'immagine della spa selezionata
      function updateSpaImage() {
        const spaSelected = document.querySelector('input[name="spa"]:checked');
        const spaImages = document.querySelectorAll('.spa-image');

        spaImages.forEach((img) => {
          img.style.display = 'none';
        });

        if (spaSelected) {
          const spaValue = spaSelected.value.toLowerCase().replace(/\s/g, '-');
          const selectedImage = document.getElementById(`spa-image-spa-${spaValue}`);
          if (selectedImage) {
            selectedImage.style.display = 'block';
          }
        }
      }

      // Popup di conferma al termine dell'invio
      window.addEventListener("message", function (event) {
        if (event.data === "formSubmitted") {
          openModal();
          hideLoading();
          // Optionally hide the form
          // document.getElementById("wellnessForm").style.display = "none";
        }
      });

      // Funzioni per aprire e chiudere il popup
      function openModal() {
        document.getElementById("confirmationModal").style.display = "block";
      }

      function closeModal() {
        document.getElementById("confirmationModal").style.display = "none";
      }

      // Chiudi il modal se l'utente clicca fuori dal contenuto
      window.onclick = function(event) {
        const modal = document.getElementById("confirmationModal");
        if (event.target == modal) {
          modal.style.display = "none";
        }
      }

      // Funzioni per l'overlay di caricamento
     
      // Impedisce lo zoom quando si interagisce con gli input
      document.addEventListener('touchmove', function(event) {
        // Solo se non si sta interagendo con un input
        const activeElement = document.activeElement;
        if (activeElement.tagName !== 'INPUT' && activeElement.tagName !== 'TEXTAREA') {
          event.preventDefault();
        }
      }, { passive: false });
    </script>
</body>
</html>

